<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>todoList</title>

<!-- 부트스트랩 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<style>
/* 폰트 적용 */
@font-face {
    font-family: 'Cafe24Ssurround';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/Cafe24Ssurround.woff') format('woff');
    font-weight: normal;
    font-style: normal;
}
body{ font-family: 'Cafe24Ssurround', sans-serif; }   
#remove{ visibility: hidden; }
li input[type="li"] {
    visibility: hidden;
}

li.completed span {
   color: lightgray;
}
#selectBtn{
	margin-bottom: 10px;
}
#todoListBox{
	text-align: center;
	margin-top: 30px;
}
#inputTodoList{
	position: relative;
	text-align: center;
}

/* 우선순위에 따른 배지 스타일 추가 */
li span.badge-very-high {
    background-color:#B0578D;
}
li span.badge-high {
    background-color: #D988B9;
}
li span.badge-normal {
    background-color: #FACBEA;
}
li span.badge-low {
    background-color: #FFE4D6;
}
</style>

</head>
<body>
	
	<div id="todoListBox">
		<h3>TO-DO LIST ✔</h3>
		<div id="selectBtn">
		<button type="button" class="btn btn-secondary btn-sm" onclick="showAll()">전체</button>
		<button type="button" class="btn btn-secondary btn-sm" onclick="showCompleted()">완료</button>
		<button type="button" class="btn btn-secondary btn-sm" onclick="showIncomplete()">미완료</button>
		<button type="button" class="btn btn-light  btn-sm" onclick="sortPriorityAscending()">우선순위 높은순</button> <!-- 수정: 우선순위 높은순 정렬 버튼 추가 -->
		<button type="button" class="btn btn-light  btn-sm" onclick="sortPriorityDescending()">우선순위 낮은순</button> <!-- 수정: 우선순위 낮은순 정렬 버튼 추가 -->
		</div>
		<br>

		<form>
         <input type="text" id="todo" style="text-align: center;" autofocus placeholder="할 일을 입력하세요">
		 <select style="height: 30px;">
			<option value="아주높음">아주높음</option>
			<option value="높음">높음</option>
			<option value="보통">보통</option>
			<option value="낮음">낮음</option>
		 </select>
         <button type="button" id="add" class="btn btn-primary btn-sm" onclick="addTodo()">추가</button>	
         <button type="button" id="remove"  class="btn btn-danger btn-sm" onclick="removeTodo()">모두 지우기</button>         </form>
         <br>		
		<ul id="todoList"></ul>
    </div> 
    
	<!-- 부트스트랩 -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script>
    	var add = document.getElementById('add');
		var remove = document.getElementById('remove');
		var todoList = document.getElementById('todoList');
		var todoInput = document.getElementById('todo');
		
		//'추가' 버튼 또는 Enter 키를 누르면 할 일을 추가하는 함수
		function addTodo () { 
			if(todoInput.value !== ''){
				var li = document.createElement('li');
				var checkbox = document.createElement('input');
				checkbox.type = 'checkbox';
				checkbox.addEventListener('change', function() {
					if (checkbox.checked) {
						li.classList.add('completed');
					} else {
						li.classList.remove('completed');
					}
				});
				
				var todoText = document.createElement('span');
				todoText.textContent = todoInput.value;
				
				var priority = document.createElement('span');
				priority.textContent = document.querySelector('select').value;

				if (priority.textContent === '아주높음') {
					priority.classList.add('badge', 'rounded-pill', 'badge-very-high');
				} else if (priority.textContent === '높음') {
					priority.classList.add('badge', 'rounded-pill', 'badge-high');
				} else if (priority.textContent === '보통') {
					priority.classList.add('badge', 'rounded-pill', 'badge-normal');
				} else {
					priority.classList.add('badge', 'rounded-pill', 'badge-low');
				}

				var editButton = document.createElement('button');
				editButton.textContent = '수정';
				editButton.classList.add('btn', 'btn-success', 'btn-sm'); // 버튼에 class 추가

				editButton.addEventListener('click', function() {
					var newTodoText = prompt('수정할 내용을 입력하세요.');
					if (newTodoText !== null) {
						todoText.textContent = newTodoText;
					}
				});
				
				li.appendChild(checkbox);
				li.appendChild(todoText);
				li.appendChild(priority);
				li.appendChild(editButton);
				todoList.appendChild(li);
				
				todoInput.value = '';
				remove.style.visibility = 'visible';
			} else {
				alert('내용을 입력해주세요.');
			}
		}

		// Enter 키가 입력되면 할 일을 추가하는 함수 호출
		todoInput.onkeydown = function(event){
			if (event.key === 'Enter') {
				event.preventDefault();
				addTodo();
			}
		}
		 
		//'모두 지우기' 버튼을 누르면 모든 할 일을 삭제하는 함수
		function removeTodo () {
			var really = confirm('할 일을 모두 지우시겠습니까?');
			if (really) {
				todoList.innerHTML = '';
				remove.style.visibility = 'hidden';
				alert('할 일이 모두 삭제되었습니다.');
			} else {
				alert('취소되었습니다.');
			}
		}

		// 할 일을 클릭하면 해당 할 일을 삭제하는 함수
		todoList.onclick = function (event) {
			var target = event.target;
			if (target.nodeName === 'LI') {
				var really = confirm('정말 지우시겠습니까?');
				if (really) {
					target.remove();
				}
			}
		}

		// '전체' 버튼을 클릭하면 모든 할 일을 보여주는 함수
		function showAll() {
			var todos = todoList.querySelectorAll('li');
			todos.forEach(function(todo) {
				todo.style.display = 'block';
			});
		}

		// '완료' 버튼을 클릭하면 완료된 할 일을 보여주는 함수
		function showCompleted() {
			var todos = todoList.querySelectorAll('li');
			todos.forEach(function(todo) {
				if (todo.classList.contains('completed')) {
					todo.style.display = 'block';
				} else {
					todo.style.display = 'none';
				}
			});
		}

		// '미완료' 버튼을 클릭하면 미완료된 할 일을 보여주는 함수
		function showIncomplete() {
			var todos = todoList.querySelectorAll('li');
			todos.forEach(function(todo) {
				if (!todo.classList.contains('completed')) {
					todo.style.display = 'block';
				} else {
					todo.style.display = 'none';
				}
			});
		}

		// '우선순위 높은순' 버튼을 클릭하면 할 일을 우선순위 높은 순으로 정렬하는 함수
		function sortPriorityAscending() {
			var todos = todoList.querySelectorAll('li');
			var sortedTodos = Array.from(todos).sort(function(a, b) {
				var priorityA = a.querySelector('span:nth-child(3)').textContent;
				var priorityB = b.querySelector('span:nth-child(3)').textContent;
				return priorityA.localeCompare(priorityB);
			});
			todoList.innerHTML = '';
			sortedTodos.forEach(function(todo) {
				todoList.appendChild(todo);
			});
		}

		// '우선순위 낮은순' 버튼을 클릭하면 할 일을 우선순위 낮은 순으로 정렬하는 함수
		function sortPriorityDescending() {
			var todos = todoList.querySelectorAll('li');
			var sortedTodos = Array.from(todos).sort(function(a, b) {
				var priorityA = a.querySelector('span:nth-child(3)').textContent;
				var priorityB = b.querySelector('span:nth-child(3)').textContent;
				return priorityB.localeCompare(priorityA);
			});
			todoList.innerHTML = '';
			sortedTodos.forEach(function(todo) {
				todoList.appendChild(todo);
			});
		}
    </script>
</body>
</html>
